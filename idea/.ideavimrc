""""" https://jb.gg/share-ideavimrc
let mapleader=" "
"" -- Idea things
set ideajoin
set ideamarks
set idearefactormode=keep
set ideastrictmode

"" easymotion
set easymotion

"" -- Nerdtree
set NERDTree
let g:NERDTreeMapActivateNode='l'
let g:NERDTreeMapJumpParent='l'
nnoremap <C-t> :NERDTreeFocus<CR>

"" -- Surround
set surround

"""" argtextobj
set argtextobj
let g:argtextobj_pairs="(:),{:},<:>"

"" -- Multiple cursors
set multiple-cursors
nmap <C-n> <plug>NextWholeOccurrence
xmap <C-n> <plug>NextWholeOccurrence
nmap g<C-n> <plug>NextOccurrence
xmap g<C-n> <plug>NextOccurrence
xmap <C-x> <plug>SkipOccurrence
xmap <C-p> <plug>RemoveOccurrence

"" matchit.vim
set matchit

"" vim-paragraph-motion
set vim-paragraph-motion

""" Yank + Clipboard
"" Don't yank
noremap ' "-
set highlightedyank
set clipboard=unnamedplus,unnamed,ideaput
set ideaput
nnoremap yy "+yy
vnoremap y "+y
nnoremap p "+p
vnoremap p "+p
nnoremap P "+P
vnoremap P "+P
vmap <leader>y "+y
vmap <leader>d "+d
nmap <leader>y "+yy
nmap <leader>p "+p
nmap <leader>P "+P
vmap <leader>p "+p
vmap <leader>P "+P

"" commentary
set commentary
""""""""""""""""""""""""""""" Vim config """"""""""""""""""""""""""""""""""""""""""""""""""""
set autoindent
set autoread
set copyindent
set cursorcolumn
set cursorline
set encoding=utf-8
set expandtab
set hlsearch
set ignorecase
set incsearch
set laststatus=2
set magic
set matchpairs
set nocompatible
set nrformats
set number relativenumber
set ruler
set shiftwidth=4
set showcmd
set showmode
set si
set signcolumn=yes
set smartcase
set smartindent
set smarttab
set so=5
set spell
set tabstop=4
set title
set ttyfast
set viminfo
set visualbell
set whichwrap=b,s,<,>,h,l,[,]
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
"" -- Map IDE actions to IdeaVim -- https://jb.gg/abva4t
vnoremap < <gv
vnoremap > >gv
map Q gq
map U <C-R>
map 0 ^
"""" ^$ The symbol is too hard to press
map gh ^
map gl $

""""""""""""""""""""""""""""Leader Maps """"""""""""""""""""""""""""""""""""""""""""""""""""""
map <leader>b <Action>(ToggleLineBreakpoint)
map <leader>j <action>(SurroundWithLiveTemplate)
map go <Action>(Switcher)
map gp <Action>(FileStructurePopup)
nmap <leader>/ <action>(ShowErrorDescription)
nmap <leader>1 <Action>(SelectInProjectView)
nmap <leader>P <action>(RecentProjectListGroup)
nmap <leader>T <action>(ReopenClosedTab)
nmap <leader>e <action>(GotoNextError)
nmap <leader>g <action>(Git.Menu)
nmap <leader>q <action>(CloseEditor)
nmap <leader>r <action>(RenameElement)
nmap <leader>ss <action>(StringManipulation.Group.Main)
nmap <leader>t <action>(ActivateTerminalToolWindow)
nmap <leader>z <action>(ToggleDistractionFreeMode)
nmap ; :
nmap gt <action>(Run)

"" cursor back
nmap <leader>u <action>(Back)

"" Split
nmap <leader>H <action>(SplitHorizontally)
nmap <leader>V <action>(SplitVertically)

"" Move Tabs
nmap <leader>k <action>(PreviousTab)
nmap <leader>h <action>(PreviousTab)
nmap <leader>a <action>(PreviousTab)
nmap <leader>j <action>(NextTab)
nmap <leader>l <action>(NextTab)
nmap <leader>d <action>(NextTab)

"""""""""""""""""""""""""""" Bookmarks """"""""""""""""""""""""""""""""""""""""""""""""""""""
nmap gb <Action>(ShowBookmarks)
nmap gm <Action>(ToggleBookmark)

"""""""""""""""""""""""""""" Other keymaps """"""""""""""""""""""""""""""""""""""""""""""""""""""
nmap <S-Enter> O<Esc>
nmap gu <action>(ShowUsages)
nmap gU <action>(FindUsages)
nmap [[ <action>(MethodUp)
nmap ]] <action>(MethodDown)
vnoremap / :action Find<CR>
nnoremap / :action Find<CR>

"""""""""""""""""""""""""""""""""""""""""""""""" Life quality """"""""""""""""""""""""""""""""""""""""""""""""
nnoremap vv V
"""" Tabs
nnoremap <S-Tab> :action PreviousTab<CR>
nnoremap <Tab> :action NextTab<CR>
"""" New files
nnoremap <leader>nf :action NewFile<CR>

""""""""""""""""""""""""""""""""""""""""""""" Handlers """""""""""""""""""""""""""""""""""""""
sethandler n:vim i:ide
sethandler <C-c> a:ide
sethandler <C-v> a:ide
sethandler <C-s> a:ide
sethandler <C-w> i:vim

""""""""""""""""""""""""""""""""""""""""""""" Folding """""""""""""""""""""""""""""""""""""""
nnoremap zx :action CollapseRegion<CR>
nnoremap zo :action ExpandRegion<CR>

""""""""""""""""""""""""""""""""""""" Leader+f? """"""""""""""""""""""""""""""""
nmap <leader><leader> <action>(ReformatCode)

nmap <leader>fd <action>(ShowIntentionActions)
nmap <leader>ff <action>(FindInPath)
nmap <leader>fg <action>(AceWordStartAction)
nmap <leader>fi <action>(OptimizeImports)
nmap <leader>fm <action>(ReformatCode)
nmap <leader>fo <action>(GotoFile)
nmap <leader>fr <action>(ReplaceInPath)
nmap <leader>fs <action>(GotoSymbol)
