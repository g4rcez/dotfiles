#!/bin/bash
########################################################################################################################
# ██████╗  ██████╗ ████████╗███████╗██╗██╗     ███████╗███████╗
# ██╔══██╗██╔═══██╗╚══██╔══╝██╔════╝██║██║     ██╔════╝██╔════╝
# ██║  ██║██║   ██║   ██║   █████╗  ██║██║     █████╗  ███████╗
# ██║  ██║██║   ██║   ██║   ██╔══╝  ██║██║     ██╔══╝  ╚════██║
# ██████╔╝╚██████╔╝   ██║   ██║     ██║███████╗███████╗███████║
# ╚═════╝  ╚═════╝    ╚═╝   ╚═╝     ╚═╝╚══════╝╚══════╝╚══════╝
########################################################################################################################
set -xe
mkdir -p $HOME/tools $HOME/.tmp
mkdir -p $HOME/.config
DIR="$HOME/dotfiles"
CONFIG_DIR="$HOME/.config"
DOT_CONFIG="$DIR/config"
source $HOME/dotfiles/zsh/utils.sh

########################################################################################################################
##### core installs
ln -sf $DIR/nvim $CONFIG_DIR/
ln -sf $DIR/zsh/zshrc $HOME/.zshrc
ln -sf $DIR/tmux $CONFIG_DIR
ln -sf $DIR/idea/.ideavimrc $HOME/.ideavimrc
ln -sf $DIR/wezterm/wezterm.lua $HOME/.wezterm.lua
ln -sf $DIR/git/gitconfig $HOME/.gitconfig

########################################################################################################################
##### brew
function installbrew() {
    NONINTERACTIVE=1 bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    bash $HOME/dotfiles/setup/brew.sh
}
checkcommand "brew" installbrew
########################################################################################################################
##### fzf
function installfzf() {
    git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf
    ~/.fzf/install
}
checkcommand "fzf" installfzf
########################################################################################################################
##### node config
function installvolta() {
    curl https://get.volta.sh | bash
    volta install node@lts
    volta pin node@lts
    volta install yarn@1.22.22
    npm i -g pnpm ts-node yarn neovim
}
checkcommand "volta" installvolta
########################################################################################################################
##### other links
ln -sf $DIR/fd/.fdignore $HOME/.fdignore
ln -sf $DIR/starship.toml $CONFIG_DIR/starship.toml
ln -sf $DIR/Raise $HOME/
ln -sf $DIR/config/alacritty/ $CONFIG_DIR
ln -sf $HOME/dotfiles/config/yazi $CONFIG_DIR
ln -sf $HOME/dotfiles/config/lazygit $HOME/.config
ln -sf $HOME/dotfiles/config/bat $HOME/.config
make
