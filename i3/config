# i3 config file (v4)
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

# Set mod key (Mod1=<Alt>, Mod4=<Super>)
set $mod Mod4
set $alt Mod1

# set default desktop layout (default is tiling)
# workspace_layout tabbed <stacking|tabbed>

# Configure border style <normal|1pixel|pixel xx|none|pixel>
new_window none
new_float none

# Hide borders
hide_edge_borders true

# change borders
bindsym $mod+u border none
bindsym $mod+y border pixel 0
bindsym $mod+n border normal

# Keyboard config
exec --no-startup-id xset r rate 160 110

# Polybar start
exec_always --no-startup-id "killall -q polybar; polybar note-top & polybar note-bot"

font pango:"Cantarell" 11px

# Use Mouse+$mod to drag floating windows
floating_modifier $mod

# start a terminal
bindsym $mod+Return exec kitty

# kill focused window
bindsym $mod+Shift+q kill
bindsym $alt+F4 kill
bindsym $mod+d kill

# launch categorized menu
bindsym $mod+z exec --no-startup-id morc_menu

# Window configs
title_align left
workspace_layout default
default_orientation vertical
popup_during_fullscreen smart

##################################################################################################
#############################  Custom keybinds and config     ####################################
##################################################################################################

# Enable numlock
exec_always --no-startup-id numlockx on

# betterlockscreen
# exec --no-startup-id betterlockscreen -w dim
bindsym $mod+9 exec --no-startup-id "i3lock"

# Music and Audio config
bindsym $mod+$alt+Shift+R exec "i3-msg restart"
# bindsym $mod+Up exec --no-startup-id "amixer set 'Master' 2%+"
# bindsym $mod+Down exec --no-startup-id "amixer set 'Master' 2%-"
bindsym $mod+m exec --no-startup-id "amixer set 'Master' 0%"

bindsym $mod+Escape exec playerctl play-pause
bindsym $mod+w exec playerctl previous
bindsym $mod+s exec playerctl next

bindsym XF86AudioStop exec playerctl stop
bindsym XF86AudioPlay exec playerctl play-pause
bindsym XF86AudioNext exec playerctl next
bindsym XF86AudioPrev exec playerctl previous

# Screen brightness controls
bindsym $mod+Right exec "xbacklight -inc 10"
bindsym $mod+Left exec "xbacklight -dec 10"
bindsym $mod+Shift+b exec "xbacklight -set 100"

# Flameshot
bindsym Print exec --no-startup-id "flameshot gui"

# Rofi menu
bindsym $alt+space exec --no-startup-id "rofi -modi window,drun,run -show drun -show-icons -theme '/home/garcez/dotfiles/rofi/rofi-menus/themes/appsmenu.rasi'"
bindsym $mod+Tab exec --no-startup-id "rofi -modi window -show window -theme /home/garcez/dotfiles/rofi/rofi-menus/themes/appsmenu.rasi -drun-icon-theme 'ePapirus' -window-format '{w} {c}'"
bindsym $alt+Tab exec --no-startup-id "rofi -modi window -show window -theme /home/garcez/dotfiles/rofi/rofi-menus/themes/appsmenu.rasi -drun-icon-theme 'ePapirus' -window-format '{w} {c}'"
bindsym $mod+F12 exec --no-startup-id bash /home/garcez/dotfiles/polybar/scripts/shutdown-menu.sh
bindsym $mod+Shift+w exec --no-startup-id "python /home/garcez/dotfiles/rofi/rofi-menus/scripts/networkmenu.py"

################################################################################################
## sound-section - DO NOT EDIT if you wish to automatically upgrade Alsa -> Pulseaudio later! ##
################################################################################################

exec --no-startup-id volumeicon
bindsym $mod+Shift+m exec kitty -e 'alsamixer'
#exec --no-startup-id pulseaudio
#exec --no-startup-id pa-applet
# bindsym $mod+Ctrl+m exec pavucontrol

################################################################################################

# Start Applications
bindsym $mod+Ctrl+b exec kitty -e 'bmenu'
bindsym $mod+F2 exec google-chrome-stable
bindsym $mod+Shift+d --release exec "killall dunst; exec notify-send 'restart dunst'"
bindsym $mod+Ctrl+x --release exec --no-startup-id xkill

focus_follows_mouse true

# change focus
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right
bindsym $mod+h focus left

# split orientation
bindsym $alt+Shift+h split h;exec notify-send 'Tile horizontally'
bindsym $alt+Shift+v split v;exec notify-send 'Tile vertically'
bindsym $alt+Shift+q split toggle;exec notify-send 'Title toggle'

# move focused window
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right
bindsym $mod+Shift+h move left

# Traditional keys for focus
# bindsym $alt+Tab focus right
# bindsym $alt+Shift+Tab focus left

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# toggle fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# toggle sticky
bindsym $mod+Shift+s sticky toggle

#navigate workspaces next / previous
bindsym $mod+$alt+Right workspace next
bindsym $mod+$alt+Left workspace prev

# Workspace names
set $ws1 1
set $ws2 2
set $ws3 3
set $ws4 4
set $ws5 5
set $ws6 6
set $ws7 7
set $ws8 8

# switch to workspace
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8

# Move focused container to workspace
bindsym $mod+Ctrl+1 move container to workspace $ws1
bindsym $mod+Ctrl+2 move container to workspace $ws2
bindsym $mod+Ctrl+3 move container to workspace $ws3
bindsym $mod+Ctrl+4 move container to workspace $ws4
bindsym $mod+Ctrl+5 move container to workspace $ws5
bindsym $mod+Ctrl+6 move container to workspace $ws6
bindsym $mod+Ctrl+7 move container to workspace $ws7
bindsym $mod+Ctrl+8 move container to workspace $ws8

# Move to workspace with focused container
bindsym $mod+Shift+1 move container to workspace $ws1; workspace $ws1
bindsym $mod+Shift+2 move container to workspace $ws2; workspace $ws2
bindsym $mod+Shift+3 move container to workspace $ws3; workspace $ws3
bindsym $mod+Shift+4 move container to workspace $ws4; workspace $ws4
bindsym $mod+Shift+5 move container to workspace $ws5; workspace $ws5
bindsym $mod+Shift+6 move container to workspace $ws6; workspace $ws6
bindsym $mod+Shift+7 move container to workspace $ws7; workspace $ws7
bindsym $mod+Shift+8 move container to workspace $ws8; workspace $ws8

# Open specific applications in floating mode
for_window [title="alsamixer"] floating enable border pixel 1
for_window [class="calamares"] floating enable border normal
for_window [class="Clipgrab"] floating enable
for_window [title="File Transfer*"] floating enable
for_window [class="Galculator"] floating enable border pixel 1
for_window [class="GParted"] floating enable border normal
for_window [title="i3_help"] floating enable sticky enable border normal
for_window [class="Lightdm-settings"] floating enable
for_window [class="Lxappearance"] floating enable sticky enable border normal
for_window [class="Manjaro-hello"] floating enable
for_window [class="Manjaro Settings Manager"] floating enable border normal
for_window [title="MuseScore: Play Panel"] floating enable
for_window [class="Nitrogen"] floating enable sticky enable
for_window [class="Oblogout"] fullscreen enable
for_window [class="octopi"] floating enable
for_window [class="Pamac-manager"] floating enable
for_window [class="Pavucontrol"] floating enable
for_window [class="qt5ct"] floating enable sticky enable border normal
for_window [class="Qtconfig-qt4"] floating enable sticky enable border normal
for_window [class="Simple-scan"] floating enable border normal
for_window [class="(?i)System-config-printer.py"] floating enable border normal
for_window [class="Skype"] floating enable border normal
for_window [class="Timeset-gui"] floating enable border normal
for_window [class="(?i)virtualbox"] floating enable border normal
for_window [class="Xfburn"] floating enable

# My for_window rules
for_window [title="(?i)Network Connections"] floating enable
for_window [title="(?i)SimpleScreenRecorder"] floating enable
for_window [class="Yad" title="yad-calendar"] floating enable

# switch to workspace with urgent window automatically
for_window [urgent=latest] focus

# reload the configuration file
bindsym $mod+Shift+c reload

# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart

# Set shut down, restart and locking features
bindsym $mod+0 mode "$mode_system"
set $mode_system (l)ock, (e)xit, switch_(u)ser, (s)uspend, (h)ibernate, (r)eboot, (Shift+s)hutdown
mode "$mode_system" {
    bindsym l exec --no-startup-id i3exit lock, mode "default"
    bindsym s exec --no-startup-id i3exit suspend, mode "default"
    bindsym u exec --no-startup-id i3exit switch_user, mode "default"
    bindsym e exec --no-startup-id i3exit logout, mode "default"
    bindsym h exec --no-startup-id i3exit hibernate, mode "default"
    bindsym r exec --no-startup-id i3exit reboot, mode "default"
    bindsym Shift+s exec --no-startup-id i3exit shutdown, mode "default"
    # exit system mode: "Enter" or "Escape"
    bindsym Return mode "default"
    bindsym Escape mode "default"
}

# Resize window (you can also use the mouse for that)
bindsym $mod+r mode "resize"
mode "resize" {
        bindsym h resize shrink width 10 px or 10 ppt
        bindsym j resize grow height 10 px or 10 ppt
        bindsym k resize shrink height 10 px or 10 ppt
        bindsym l resize grow width 10 px or 10 ppt
        # same bindings, but for the arrow keys
        bindsym Left resize shrink width 10 px or 10 ppt
        bindsym Down resize grow height 10 px or 10 ppt
        bindsym Up resize shrink height 10 px or 10 ppt
        bindsym Right resize grow width 10 px or 10 ppt
        # exit resize mode: Enter or Escape
        bindsym Return mode "default"
        bindsym Escape mode "default"
}

# Autostart applications
exec --no-startup-id nitrogen --restore; sleep 1;
exec --no-startup-id xfce4-power-manager
exec --no-startup-id "compton -cbf"
exec --no-startup-id /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
exec --no-startup-id nm-applet
# exec_always --no-startup-id ff-theme-util
exec_always --no-startup-id fix_xcursor

set_from_resource $term_background background
set_from_resource $term_foreground foreground
set_from_resource $term_color0     color0
set_from_resource $term_color1     color1
set_from_resource $term_color2     color2
set_from_resource $term_color3     color3
set_from_resource $term_color4     color4
set_from_resource $term_color5     color5
set_from_resource $term_color6     color6
set_from_resource $term_color7     color7
set_from_resource $term_color8     color8
set_from_resource $term_color9     color9
set_from_resource $term_color10    color10
set_from_resource $term_color11    color11
set_from_resource $term_color12    color12
set_from_resource $term_color13    color13
set_from_resource $term_color14    color14
set_from_resource $term_color15    color15

#############################
### settings for i3-gaps: ###
#############################

# Set inner/outer gaps
gaps inner 2
gaps outer -2

# Smart gaps (gaps used if only more than one container on the workspace)
smart_gaps on

# bar {
#     font pango: NotoSans,Icons 8
# 	position top
# 	mode dock
#     height 13
# 	position top
# 	mode dock
#     tray_output primary
#     status_command i3status
#     separator_symbol\ 
#     workspace_buttons yes
#     modifier Mod1
#     # colors {
#     #     separator  #eeeeee
#     #     background #000000
#     #     statusline #eeeeee #border  backgr.  text
#     #     focused_workspace  $color1 $000000 $color1
#     #     inactive_workspace #eeeeee #000000 #eeeeee
#     #     urgent_workspace   #1bb2f2 #000000 #1bb2f2
#     # }
# }

# Mouse movement
bindsym $mod+Ctrl+Shift+m mode "mouse"
mode "mouse" {
	# set your three speeds here
	set $slow 10
	set $quick 10
	set $fast 10

	bindsym a exec xdotool mousemove_relative -- -$slow 0
	bindsym s exec xdotool mousemove_relative 0 $slow
	bindsym w exec xdotool mousemove_relative -- 0 -$slow
	bindsym d exec xdotool mousemove_relative $slow 0

	# Mouse movement (slow/fine-tuned) -- vim keybindings
	bindsym h exec xdotool mousemove_relative -- -$slow 0
	bindsym j exec xdotool mousemove_relative 0 $slow
	bindsym k exec xdotool mousemove_relative -- 0 -$slow
	bindsym l exec xdotool mousemove_relative $slow 0

	# Mouse movement (slow/fine-tuned) -- arrow keys
	bindsym Left exec xdotool mousemove_relative -- -$slow 0
	bindsym Down exec xdotool mousemove_relative 0 $slow
	bindsym Up exec xdotool mousemove_relative -- 0 -$slow
	bindsym Right exec xdotool mousemove_relative $slow 0

	# Mouse movement (quicker) -- vim keybindings
	bindsym Shift+h exec xdotool mousemove_relative -- -$quick 0
	bindsym Shift+j exec xdotool mousemove_relative 0 $quick
	bindsym Shift+k exec xdotool mousemove_relative -- 0 -$quick
	bindsym Shift+l exec xdotool mousemove_relative $quick 0

	# Mouse movement (quicker) -- arrow keys
	bindsym Shift+Left exec xdotool mousemove_relative -- -$quick 0
	bindsym Shift+Down exec xdotool mousemove_relative 0 $quick
	bindsym Shift+Up exec xdotool mousemove_relative -- 0 -$quick
	bindsym Shift+Right exec xdotool mousemove_relative $quick 0

	# Mouse movement (fast) -- vim keybindings
	bindsym Shift+$mod2+h exec xdotool mousemove_relative -- -$fast 0
	bindsym Shift+$mod2+j exec xdotool mousemove_relative 0 $fast
	bindsym Shift+$mod2+k exec xdotool mousemove_relative -- 0 -$fast
	bindsym Shift+$mod2+l exec xdotool mousemove_relative $fast 0

	# Mouse movement (fast) -- arrow keys
	bindsym Shift+$mod2+Left exec xdotool mousemove_relative -- -$fast 0
	bindsym Shift+$mod2+Down exec xdotool mousemove_relative 0 $fast
	bindsym Shift+$mod2+Up exec xdotool mousemove_relative -- 0 -$fast
	bindsym Shift+$mod2+Right exec xdotool mousemove_relative $fast 0

	# Left Click
	bindsym q exec xdotool click 1

	# Middle Click
	bindsym Shift+w exec xdotool click 2

	# Right Click
	bindsym e exec xdotool click 3

	# Left Click-and-drag
	# bindsym Shift+f exec xdotool mousedown 1

	# Middle Click-and-drag 
	# bindsym Shift+d exec xdotool mousedown 2

	# Right Click-and-drag
	# bindsym Shift+s exec xdotool mousedown 3

	# Left Drag release
	# bindsym $mod2+f exec xdotool mouseup 1

	# Middle Drag release
	# bindsym $mod2+d exec xdotool mouseup 2

	# Right Drag release
	# bindsym $mod2+s exec xdotool mouseup 3
	# return to normal keybindings -- IMPORTANT!!
	bindsym Escape mode "default"
}