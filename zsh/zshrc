#!/bin/zsh
eval "$(zoxide init zsh)"
##################################### Mandatory Config ##############################
CASE_SENSITIVE="false"
COMPLETIONS="$DOTFILES/zsh/completions"
DISABLE_UNTRACKED_FILES_DIRTY="true"
DOTFILES="$HOME/dotfiles"
ENABLE_CORRECTION="true"
HIST_STAMPS="yyyy-mm-dd"
HYPHEN_INSENSITIVE="true"
ZELLIJ_AUTO_ATTACH=true
ZELLIJ_DEFAULT_SESSION="main"
ZSH_TMUX_AUTOSTART=true
ZSH_TMUX_DEFAULT_SESSION_NAME="main"
############################################ CLIs ##########################################
export SDKMAN_DIR="$HOME/.sdkman"
SOURCES=(
  "$HOME/.oh-my-zsh/oh-my-zsh.sh"
  "$DOTFILES/bin/fzf-git"
  "$HOME/.ghcup/env"
  "$HOME/tools/google-cloud-sdk/path.zsh.inc"
  "$HOME/tools/google-cloud-sdk/completion.zsh.inc"
  "$HOME/.fzf.zsh"
  "$HOME/.fzf/shell/key-bindings.zsh"
  "$SDKMAN_DIR/bin/sdkman-init.sh"
)
for SOURCE in $SOURCES; do [[ -f "$SOURCE" ]] && source "$SOURCE"; done
############################################ zap-zsh ###########################################
SNAP_DIR="$HOME/.znap"
zstyle ':znap:*' repos-dir "$SNAP_DIR"
[[ -r "$SNAP_DIR" ]] || git clone --depth 1 -- https://github.com/marlonrichert/zsh-snap.git "$SNAP_DIR"
source "$SNAP_DIR/znap.zsh";

local -a plugins=(
    zsh-users/zsh-completions
    MichaelAquilina/zsh-you-should-use
    marzocchi/zsh-notify
    marlonrichert/zcolors               # Colors for completions and Git
    wfxr/forgit
    hlissner/zsh-autopair
    zsh-users/zsh-syntax-highlighting   # Command-line syntax highlighting
    zsh-users/zsh-autosuggestions       # Inline suggestions
)

znap clone $plugins
for plugin in $plugins; do znap source $plugin; done
znap eval iterm2 "curl -fsSL https://iterm2.com/shell_integration/zsh"
znap eval starship 'starship init zsh'
znap prompt
############################################# config ###################################################################
zmodload zsh/complist
autoload -U +X bashcompinit && bashcompinit
autoload -U compinit
compinit

local -a sources=(
  $COMPLETIONS/yarn
  $COMPLETIONS/zellij
  $COMPLETIONS/docker
  $DOTFILES/zsh/export.sh
  $DOTFILES/zsh/git.sh
  $DOTFILES/zsh/alias.sh
  $DOTFILES/zsh/zstyle.sh
)

for fileSource in $sources; do [ -f "$fileSource" ] && source "$fileSource"; done
#################################################### autostart zellij ##################################################
if [[ -z "$ZELLIJ" && "$USE_ZELLIJ" == "true" ]]; then
  zellij attach -c "$ZELLIJ_DEFAULT_SESSION"
fi

